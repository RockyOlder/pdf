require.config({paths:{conversion:"conversion/conversion",wxLogin:"http://res.wx.qq.com/connect/zh_CN/htmledition/js/wxLogin"}}),require(["jquery","conversion","jquery.ui.widget","jquery.iframe-transport","jquery.fileupload","remindSendConfirm","xcConfirm","tool","wxLogin"],function($,conversion,widget,transport,fileupload,remindSendConfirm,xcConfirm,tool,wxLogin){"use strict";""!==$("#email").val()&&$(".email_div").show();var $list=$(".list"),url="/Home/Index/upload";$("#fileupload").fileupload({url:url,sequentialUploads:!0,acceptFileTypes:"/(.|/)(doc|docx|xls|xlsx|ppt|pptx|pdf)$/i",autoUpload:!1,done:function(e,data){var lvContent="";if(lvContent="string"!=typeof data.result?data.result[0].body.innerText:data.result,data=eval("("+lvContent+")"),1==data.files.state)tool.fileAjax(data.files,"upload_name_save");else{if(9==data.files.state)return window.wxc.xcConfirm(data.files.error_msg,window.wxc.xcConfirm.typeEnum.warning),!1;if(0==data.files.state)return window.wxc.xcConfirm(data.files.error_msg,window.wxc.xcConfirm.typeEnum.warning),!1;8!=data.files.state&&5!=data.files.state&&4!=data.files.state||tool.fileAjax(data.files,"upload_cype_save")}$(".upload").show(),conversion.listHtml(data.files,data.files.state)},add:function(e,i){if(i.files.length+$(".table tbody tr").length>10){var n="您上传的文档超过数量（10个），请清理列表后，再重新上传";return window.wxc.xcConfirm(n,window.wxc.xcConfirm.typeEnum.warning),!1}var t=1;if(""==$("#gy_member_open").val()){var o={title:"提示",btn:parseInt("0011",2),onOk:function(){var e="/Home/Index/weixinlogin";$.ajax({url:e,dataType:"html",data:{redirect:$("#redirect").val()},type:"post",async:!1,success:function(e){$(".popup_weixin").html(e),$(".popup_weixin").show(),$(".popup_weixin .content").css({"margin-top":($(window).height()-460)/2}),$(".popup_weixin .close").click(function(){$("#weixin_ifram").remove(),$(".popup_weixin").hide()})}})}};return window.wxc.xcConfirm("您需要登录后才可以进行文档转换",window.wxc.xcConfirm.typeEnum.warning,o),!1}return $(".choose_file .label").hasClass("checked")?($.each(i.files,function(e,i){var n=i.name.substr(i.name.lastIndexOf("."));if((0==conversion.getTypeUpload(n.toLowerCase())||""==i.type)&&0==conversion.getTypeUpload(n.toLowerCase()))return window.wxc.xcConfirm("上传的文件格式不正确，请重新上传",window.wxc.xcConfirm.typeEnum.warning),!1;if(i.size>20971520){t=2,conversion.listHtmlFind(i,5,t,1),i.ext=i.name.substr(i.name.lastIndexOf("."));var o={fileName:i.name,fsize:i.size,cstate:0,type:i.ext};return tool.fileAjax(o,"bigupload"),!1}conversion.listHtmlFind(i,14)}),void(2!==t&&i.submit())):(window.wxc.xcConfirm("需要勾选才能转换",window.wxc.xcConfirm.typeEnum.warning,o),!1)},drop:function(e,i){if(i.files.length+$(".table tbody tr").length>10){var n="您上传的文档超过数量（10个），请清理列表后，再重新上传";return window.wxc.xcConfirm(n,window.wxc.xcConfirm.typeEnum.warning),!1}},progress:function(e,i){var n=parseInt(i.loaded/i.total*100,10);$(".table tbody tr").each(function(){i.files[0].name==$(this).find("td").eq(1).children("div").find("h3").html()&&$(this).find("td").eq(1).find(".progress_bar").css("width",n+"%"),100==n&&i.files[0].name==$(this).find("td").eq(1).children("div").find("h3").html()&&$(this).find("td").eq(1).find(".progress_bar").hide(100)})}}).prop("disabled",!$.support.fileInput),tool.ActivityStatistics(),tool.WeixinLogin(),tool.brandCommon(),conversion.init(),tool.ShowCountDown()});