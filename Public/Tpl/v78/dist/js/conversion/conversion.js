define(["tool"],function(e){return conversion={single_url:"/Home/Index/batchConversion",batch_url:"/Home/Index/batchConversion",_this_ajaxLoadMember_conversion_type:document.getElementById("Authorizationtype").value,_this_ajaxLoadMember_free_authorization:document.getElementById("Free_authorization").value,_this_number_Permission_0:0,_this_number_Permission_1:1,_this_number_Permission_2:2,_this_number_Permission_3:3,init:function(){this.RunOnBeforeUnload(),this.delete_one(),this.jquery_event()},startTransition:function(t,i){var a=parseInt($(t).parents("tr").find("td").eq(0).attr("number_page_pdf")),s=$(t).parents("tr").find("td").eq(3).find("div").text(),n=$(t).parents("tr").find("td").eq(0).children("label").find("i").attr("file-failure");if(n==conversion._this_number_Permission_2&&$(t).parents("tr").find("td").eq(0).children("label").find("i").attr("file-state","successful"),$("#Authorizationtype").val()==this._this_number_Permission_1)if(a>500){$(t).parents("tr").find("td").eq(6).find("div").removeClass("success").addClass("failure").html("文档页数超出限制,请充值后尝试"),$(t).removeClass("reture_switch").removeClass("start_switch").addClass("rg_vip").removeAttr("onclick").html(this.getHost(6));var r=$(t).parents("tr").find("td").eq(0).attr("id");e.fileAjax({fileId:r},"upload_state_save"),window.rsd.rsdConfirm("content_split")}else conversion.AskstartTransition(t,i);else if($("#Authorizationtype").val()==this._this_number_Permission_0)if($("#Free_authorization").val()==this._this_number_Permission_0)if("PDF"==s){$(t).parents("tr").find("td").eq(6).find("div").removeClass("success").addClass("failure").html("每日可免费转换一次50页PDF"),$(t).removeClass("reture_switch").removeClass("start_switch").addClass("rg_vip").removeAttr("onclick").html(this.getHost(6));var r=$(t).parents("tr").find("td").eq(0).attr("id");e.fileAjax({fileId:r},"upload_state_six")}else conversion.AskstartTransition(t,i);else if(a>50){var d={onOk:function(){conversion.AskstartTransition(t,i)}};window.rsd.rsdConfirm("content_overflow",d)}else conversion.AskstartTransition(t,i);else conversion.AskstartTransition(t,i)},AskstartTransition:function(t,i){e.checkNotEmpty(i)||(i=this.single_url);var a=$(t).parents("tr").find("td").eq(0).children("label").find("i").attr("file-state");if("failure"==a||"await"==a||"start"==a||"on"==a)return!1;var s=$(t).parents("tr").find("td").eq(1).children("div").find("h3").html(),n=$(t).parents("tr").find("td").eq(5).find(".drop").find("div").html(),r=$(t).parents("tr").find("td").eq(0).attr("id"),d=$(t).parents("tr").find("td").eq(0).children("label").find("i").attr("alt"),l=$(t).attr("acc");if(!e.checkNotEmpty(l))var l=$(t).parents("tr").find("td").eq(0).attr("acc");var o=$(t).parents("tr").find("td").eq(0).attr("del-time"),f=$("#fileVal").val().split(","),c=n+"_"+d+"_"+s,v=[];$(t).parents("tr").find("td").eq(6).find("div").removeClass("success").addClass("now_switch").html("正在转换"),$(t).parents("tr").find("td").eq(5).find("div").attr("name","disabled").addClass("rmoveData"),$(t).parents("tr").find("td").eq(7).find("div").removeClass("reture_switch start_switch").addClass("loading").removeAttr("onclick").html("");var h=$(".sendfor_email .checked").length;if(1==h)var m=$("#email").val();v.push({fileName:s,fileType:n,fileSize:d,suffix:l,fileTime:o,id:r,email:m}),v.length>0&&$.ajax({type:"post",url:i,data:{fileInfo:JSON.stringify(v)},dataType:"json",success:function(i){if(1==i.action){var a=i.success[0],s=$(t).parents("tr").find("td").eq(3).find("div").text();$(t).parents("tr").find("td").eq(0).attr("del-time");e.fileAjaxAsynchronous(v,"timngProcess"),1==a.fileState?($(t).parents("tr").find("td").eq(7).find("div").removeClass("failure loading").addClass("now_down").html("下载").attr("onclick","conversion.getDownload(this,'"+a.m_id+"')"),$(t).parents("tr").find("td").eq(6).find("div").removeClass("failure now_switch").addClass("success").html("转换成功"),$(t).parents("tr").find("td").eq(5).find(".drop").attr("name","disabled").addClass("rmoveData"),$(t).parents("tr").find("td").eq(0).children("label").find("i").attr("file-state","on"),$(t).parents("tr").find("td").eq(0).children("label").removeClass("checked"),f.push(c),$("#fileVal").val(f.join(",")),clearTimeout(conversion.AskstartTransition),"PDF"==s&&1==$("#Free_authorization").val()&&$("#Authorizationtype").val()==conversion._this_number_Permission_0&&(window.rsd.rsdConfirm("content_success"),$("#Free_authorization").val(0)),e.ajaxLoadShoppingMember(),e.ajaxLoadShoppingHeader()):2==a.fileState?($(t).parents("tr").find("td").eq(7).find("div").removeClass("loading").addClass("reture_switch").html("重新转换").attr("onclick","conversion.startTransition(this)"),$(t).parents("tr").find("td").eq(6).find("div").addClass("failure").html("转换失败"),clearTimeout(conversion.AskstartTransition)):5==a.fileState?($(t).parents("tr").find("td").eq(7).find("div").removeClass("loading now_down").addClass("down_client").html('<a href="http://file1.cqttech.com/soft/Yueshu/YueShuPDF_setup.exe" target="_blank">下载客户端</a>'),$(t).parents("tr").find("td").eq(6).find("div").addClass("failure").html("转换超时"),clearTimeout(conversion.AskstartTransition)):setTimeout(function(){conversion.AskstartTransition(t,"/Home/Index/batchConversionAjax")},5e3)}}})},RunOnBeforeUnload:function(){this.onloadQuery(),window.onbeforeunload=function(){closeStr="当前操作将丢失上传和转换的文档，确认执行该操作？";var e=$(".list > li").length;if(e>0)return closeStr}},onloadQuery:function(){var t=e.getCookie("timestamp");$.ajax({type:"post",url:"/Home/Index/fileRequest",data:{verify:"PDF",timestamp:t},dataType:"json",success:function(t){if("undefined"!=typeof t.action&&1==t.action){var i=t.success;$(".upload").show();for(var a=0;a<i.length;a++){var s=conversion.refreshListHtml(i[a]);$(".table").append(s),7==i[a].fstate&&conversion.AskstartTransition($(".table").find("tbody").find("tr:eq("+a+")").find("td").eq(7).find("div"),"/Home/Index/batchConversionAjax")}}else window.timestamp=Date.parse(new Date)/1e3,e.setCookie("timestamp",window.timestamp,.354)}})},refreshListHtml:function(e){if("undefined"!=typeof e.timestamp&&e.timestamp){var t=e.timestamp;window.timestamp=t}else var t=window.timestamp;if(1==e.fdown||8==e.c_fsiz_state||2==e.c_type_state)var i="on";else if(8==e.c_fsiz_state||2==e.c_type_state)var i="await";else if(6==e.fstate)var i="await";else if(9==e.fstate)var i="await";else var i="successful";var a="",s=e.ftype.toLowerCase(),n=e.ctype.toLowerCase(),r="";if(7==e.fstate&&(r="checked"),a+="<tr>",a+='<td id="'+e.id+'"acc="'+s+'" del-time="'+t+'" f-name="'+e.cname+'" number_page_pdf="'+e.number_page+'" ><label class="label '+r+'"><i class="icon" alt="'+e.fsize+'" file-state="'+i+'" file-state_type="'+e.fstate+'"  ></i></label></td>',"doc"==s||"docx"==s)var d="icon icon_doc";else if("ppt"==s||"pptx"==s)var d="icon icon_ppt";else if("xlsx"==s||"xls"==s)var d="icon icon_xls";else if("pdf"==s)var d="icon icon_pdf";else var d="icon icon_doc";a+='<td><div class="txt_name">  <i class="'+d+'"></i><div class="txt"><h3>'+e.fname+"</h3></div></div> </td>",a+=0!=e.number_page?"<td>"+e.number_page+"页</td>":"<td>/</td>";var l=this.getType(s),o=this.getType(n);if(l)if("PDF"!=l){var f=["PDF"];a+='<td><div class="file_format">'+l+"</div></td>",a+="<td>转</td>",a+='<td><div class="drop" name="disabled"><div class="info">'+f[0]+'</div><div class="caret"></div></div></td>'}else{var f=["Word"];a+='<td><div class="file_format">'+l+"</div></td>",a+="<td>转</td>",a+=1==e.fdown&&1==e.cstate?'<td><div class="drop" name="disabled"><div class="info">'+o+'</div><div class="caret"></div></div></td>':'<td><div class="drop"><div class="info">'+f[0]+'</div><div class="caret"></div><ul class="secondary"><li>Excel</li><li>Word</li><li>PPT</li></ul></div></td>'}else{l=s.toUpperCase();var f=[""]}if(0!=e.fdown)var c=1==e.fdown?20:22;else if(1==e.cstate)var c=1==e.cstate?20:22;else if(2==e.cstate)var c=2==e.cstate?16:22;else if(0!=e.fstate)if(2==e.fstate)var c=3;else var c=e.fstate;if(20==c||1==c)var v="state success";else if(16==c||3==c||4==c||12==c||10==c||11==c||13==c||14==c)var v="state failure";else if(8==c||5==c)var v="state failure";else if(6==c)var v="state failure";else if(9==c)var v="state failure";else if(7==c)var v="state success";a+='<td><div class="'+v+'">'+this.getHint(c)+"</div></td>";var h="",m="",p="",u="",_="off";if(20==c||22==c){var b="operation now_down";h="display: inline-block;",m="onclick=\"conversion.getDownload(this,'"+e.m_id+"')\"",u="下载",_="on"}else if(16==c){var b="operation reture_switch";p='onclick="conversion.startTransition(this)"',u="重新转换"}else if(1==c&&1!=$("#pdf_authorization").val()){var b="operation start_switch";p='onclick="conversion.startTransition(this)"',u="开始转换"}else if(3==c){var b="operation reture_switch";u="重新选择"}else if(5==c){var b="operation reture_switch";p='onclick="conversion.startTransition(this)"',u="重新转换"}else if(8==c||1==$("#pdf_authorization").val()){var b="operation reture_switch";u="上传失败"}else if(4==c){var b="operation rg_vip";u="人工vip"}else if(6==c){var b="operation rg_vip";u='<a style="color: #fff;" href="/Home/Products/ConversionFeeDetail" >立即充值</a>'}else if(9==c){var b="operation rg_vip";u='<a style="color: #fff;" href="/Home/Products/ConversionFeeDetail" >立即充值</a>'}else if(7==c){var b="operation start_switch";p='onclick="conversion.startTransition(this)"',u="开始转换"}else if(c>=10&&c<=14){var b="operation reture_switch";u="上传失败"}return a+='<td><div class="'+b+'" alt="'+e.fname+'" acc="'+s+'" file-time="'+e.postfix+'"   '+p+" "+m+">"+u+"</div></td>",a+='<td><i class="icon icon_delete" alt="'+e.fname+'" ></i></td>',a+="\t</tr>"},getType:function(e){if(e){switch(e=e.toLowerCase()){case"doc":case"docx":$type="Word";break;case"xls":case"xlsx":$type="Excel";break;case"ppt":case"pptx":$type="PPT";break;case"pdf":$type="PDF";break;default:$type=0}return $type}},getHint:function(e){if(e){var t=parseInt(e);switch(t){case 1:var i="上传成功";break;case 2:var i="该文件已有";break;case 3:var i="上传失败";break;case 4:var i='<a href="http://file1.cqttech.com/soft/Yueshu/YueShuPDF_setup.exe" target="_blank">下载客户端</a>';break;case 5:var i="转换超时";break;case 6:var i="每日可免费转换1次50页pdf";break;case 7:var i="正在转换";break;case 8:var i="文件重复";break;case 9:var i="文档页数超出限制,请充值后尝试操作";break;case 10:var i="内存不足";break;case 11:var i="文档需要密码";break;case 12:var i="文档已损坏,无法打开";break;case 13:var i="文档保存失败";break;case 14:var i="运行环境错误";break;case 15:var i="转换成功";break;case 16:var i="转换失败";break;case 20:var i="转换成功";break;default:var i=""}return i}},getHost:function(e){if(e){var t=parseInt(e);switch(t){case 1:var i="上传成功";break;case 2:var i="该文件已有";break;case 3:var i="上传失败";break;case 4:var i='<a href="http://file1.cqttech.com/soft/Yueshu/YueShuPDF_setup.exe" target="_blank">下载客户端</a>';break;case 5:var i='<a href="http://file1.cqttech.com/soft/Yueshu/YueShuPDF_setup.exe" target="_blank">下载客户端</a>';break;case 6:var i='<a style="color:#fff" href="/Home/Products/ConversionFeeDetail" >立即充值</a>';break;case 7:var i="服务器临时文件夹丢失";break;case 8:var i="上传失败";break;case 9:var i="文件写入失败";break;case 10:var i="PHP文件上传扩展没有打开";break;case 11:var i="格式不支持";break;case 12:var i="下载链接已失效";break;case 13:var i="正在上传";break;case 14:var i="正在上传";break;case 15:var i="转换成功";break;case 16:var i="转换失败";break;default:var i=""}return i}},getDownload:function(t,i){var a=$(t).parents("tr").find("td").eq(5).find(".drop").find("div").html(),s=$(t).parents("tr").find("td").eq(1).children("div").find("h3").html(),n=($(t).parents("tr").find("td").eq(7).find("div").attr("file-time"),$(t).parents("tr").find("td").eq(0).children("label").find("i").attr("alt")),r=$(t).parents("tr").find("td").eq(0).attr("del-time"),d=$(t).parents("tr").find("td").eq(0).attr("id");$.ajax({type:"post",url:"/Home/Index/ajaxDownload",data:{downType:a,fileName:s,downIp:i,fileTime:r,fileId:d},dataType:"json",async:!1,success:function(i){if(1==i.action){var l="/Home/Index/download?url="+i.downUrl+"&key="+i.key+"&downType="+a+"&id="+i.fileId;location.href=encodeURI(encodeURI(l));var o=[{fid:d,fileName:s,fsize:n,fdown:1,cTime:r}]}else{var f=conversion.getHint(i.action);$(t).parents("tr").find("td").eq(6).find("div").addClass("failure").html("下载链接已失效"),$(t).siblings(".span").removeClass("after").addClass("before").html(f),$(t).removeClass("now_down").addClass("failure").html("下载过期");var c=$(t).siblings(".label").html(),v=$(t).siblings("i").attr("alt"),h=c+"_"+v+"_"+s,m=$("#fileVal").val().split(","),p=$.inArray(h,m);p!=-1&&(m.splice(p,1),$("#fileVal").val(m.join(",")));var o=[{fid:d,fileName:s,fsize:n,fdown:2,cTime:r}]}e.fileAjax(o,"fileDownLoad")}})},listHtml:function(e,t){for(var i=$(".table tbody tr"),a=i.length,s=0;s<a;s++){var n=i.eq(s),r=n.find("td").eq(1).children("div").find("h3").text(),d=n.find("td").eq(0).attr("md5file"),l=n.find("td").eq(0).children("label").find("i").attr("file-state_type"),o=n.find("td").eq(0).children("label").find("i").attr("file-state"),f=n.find("td").eq(0).attr("id");"undefined"==typeof f&&d!=e.md5file&&r==e.tname&&"successful"!==o&&"4"!==l&&"5"!==l&&"8"!==l&&(1==e.state?(n.find("td").eq(7).find("div").html("开始转换").attr("onclick","conversion.startTransition(this)"),n.find("td").eq(0).attr("id",e.id),n.find("td").eq(0).attr("del-time",e.fileTime),n.find("td").eq(0).attr("md5file",e.md5file),n.find("td").eq(0).attr("number_page_pdf",e.number_page_pdf),0!=e.number_page_pdf&&n.find("td").eq(2).html(e.number_page_pdf+"页"),n.find("td").eq(0).children("label").find("i").attr("file-state",e.success),n.find("td").eq(0).children("label").addClass("checked"),n.find("td").eq(6).find("div").removeClass("failure").addClass("success").html(e.error_msg)):(5==e.state||4==e.state?n.find("td").eq(7).find("div").removeClass("start_switch").addClass("down_client").html(this.getHost(e.state)):6==e.state?n.find("td").eq(7).find("div").removeClass("start_switch").addClass("rg_vip").html(this.getHost(e.state)):e.state>=10&&e.state<=14?n.find("td").eq(7).find("div").removeClass("start_switch").addClass("reture_switch").html(this.getHost(3)):n.find("td").eq(7).find("div").removeClass("start_switch").addClass("reture_switch").html(this.getHost(e.state)),0!=e.number_page_pdf&&n.find("td").eq(2).html(e.number_page_pdf+"页"),n.find("td").eq(0).attr("md5file",e.fileTime),n.find("td").eq(5).find(".drop").attr("name","disabled").addClass("rmoveData"),n.find("td").eq(0).attr("id",e.id),n.find("td").eq(0).attr("number_page_pdf",e.number_page_pdf),n.find("td").eq(0).children("label").find("i").attr("file-state",e.success),n.find("td").eq(0).children("label").find("i").attr("file-state_type",e.state),n.find("td").eq(6).find("div").html(e.error_msg)))}},getTypeUpload:function(e){if(e){switch(e=e.toLowerCase()){case".doc":$type="Word";break;case".docx":$type="Word";break;case".xls":$type="Excel";break;case".xlsx":$type="Excel";break;case".ppt":$type="PPT";break;case".pptx":$type="PPT";break;case".pdf":$type="PDF";break;default:$type=0}return $type}},listHtmlFind:function(e,t,i,a){if("undefined"==typeof e.time)var s=window.timestamp;else var s=e.time;var n="";n+="<tr>",n+='<td del-time="'+s+'" ><label class="label"><i class="icon" alt="'+e.size+'" file-state="start"  ></i></label></td>';var r=e.name.substr(e.name.lastIndexOf("."));if(e.ext=r.toLowerCase(),"Word"==this.getTypeUpload(e.ext))var d="icon icon_doc";else if("PPT"==this.getTypeUpload(e.ext))var d="icon icon_ppt";else if("Excel"==this.getTypeUpload(e.ext))var d="icon  icon_xls";else if("PDF"==this.getTypeUpload(e.ext))var d="icon icon_pdf";else var d="icon icon_doc";n+='<td><div class="txt_name">  <i class="'+d+'"></i><div class="txt"><h3>'+e.name+'</h3> <div class="progress_bar"></div></div></div> </td>',n+="<td>/</td>";var l=this.getTypeUpload(e.ext);if(l)if("PDF"!=l){var o=["PDF"];n+='<td><div class="file_format">'+l+"</div></td>",n+="<td>转</td>",n+='<td><div class="drop" name="disabled"><div class="info">'+o[0]+'</div><div class="caret"></div></div></td>'}else{var o=["Word"];n+='<td><div class="file_format">'+l+"</div></td>",n+="<td>转</td>",n+=2==i?'<td><div class="drop rmoveData" name="disabled"><div class="info">'+o[0]+'</div><div class="caret"></div><ul class="secondary"><li>Excel</li><li>Word</li><li>PPT</li></ul></div></td>':'<td><div class="drop" ><div class="info">'+o[0]+'</div><div class="caret"></div><ul class="secondary"><li>Excel</li><li>Word</li><li>PPT</li></ul></div></td>'}else{l=e.ext.toUpperCase();var o=[""]}if(n+=2==i?0==a?'<td><div class="state failure">文档大小超出限制请充值后重试</div></td>':'<td><div class="state failure">文档大小超出限制请尝试客户端转换</div></td>':'<td><div class="state failure">正在上传</div></td>',2==i)var f="operation down_client";else var f="operation start_switch";n+='<td><div class="'+f+'" alt="'+e.name+'" acc="'+e.ext+'" file-time="'+e.lastModified+'"  >'+this.getHost(t)+"</div></td>",n+='<td><i class="icon icon_delete" alt="'+e.name+'" ></i></td>',n+="\t</tr>",$(".table tbody").prepend(n)},batchConversion:function(t){e.checkNotEmpty(t)||(t=this.batch_url);var i={_this_number_page_pdf:0,_this_text_msg:"",init:function(){this.AskBatchConversion(t)},AskBatchConversion:function(t){if($(".upload_file .checked").each(function(){var t=$(this).parents("tr").find("td").eq(0).attr("number_page_pdf"),a=$(this).parents("tr").find("td").eq(0).children("label").find("i").attr("file-failure"),s=$(this).parents("tr").find("td").eq(3).find("div").text();a==conversion._this_number_Permission_2&&$(this).find("i").attr("file-state","successful");var n=$(this).find("i").attr("file-state");return"failure"==n||"await"==n||"start"==n||"on"==n?($(this).parents("tr").find("td").eq(0).children("label").removeClass("checked"),!0):void($("#Authorizationtype").val()==conversion._this_number_Permission_1?t>500&&($(this).parents("tr").find("td").eq(6).find("div").removeClass("success").addClass("failure").html("文档页数超出限制,请充值后尝试"),$(this).parents("tr").find("td").eq(7).find("div").removeClass("start_switch").addClass("rg_vip").removeAttr("onclick").html(conversion.getHost(6)),$(this).find("i").attr("file-state","failure"),e.fileAjax({fileId:$(this).parents("tr").find("td").eq(0).attr("id")},"upload_state_save"),i._this_number_page_pdf=conversion._this_number_Permission_2):$("#Authorizationtype").val()==conversion._this_number_Permission_0&&($("#Free_authorization").val()==conversion._this_number_Permission_0?"PDF"==s&&($(this).parents("tr").find("td").eq(6).find("div").removeClass("success").addClass("failure").html("每日可免费转换一次50页PDF"),$(this).parents("tr").find("td").eq(7).find("div").removeClass("start_switch reture_switch").addClass("rg_vip").removeAttr("onclick").html(conversion.getHost(6)),$(this).find("i").attr("file-state","failure"),e.fileAjax({fileId:$(this).parents("tr").find("td").eq(0).attr("id")},"upload_state_six"),i._this_number_page_pdf=conversion._this_number_Permission_3):t>50&&(i._this_number_page_pdf=conversion._this_number_Permission_1)))}),i._this_number_page_pdf==conversion._this_number_Permission_1){var a={onOk:function(){i.AskBatchConversionSendPerform(t)}};window.rsd.rsdConfirm("content_overflow",a)}else i._this_number_page_pdf==conversion._this_number_Permission_2?(window.rsd.rsdConfirm("content_split"),i.AskBatchConversionSendPerform(t)):i.AskBatchConversionSendPerform(t)},AskBatchConversionSendPerform:function(t){var a=$(".upload_file .checked").length;if(a>0){var s=[];$(".upload_file .checked").each(function(){var e=$(this).parents("tr").find("td").eq(1).children("div").find("h3").html(),t=($(this).parents("tr").find("td").eq(3).find("div").html(),$(this).parents("tr").find("td").eq(5).find(".drop").find("div").html()),i=$(this).parents("tr").find("td").eq(7).find("div").attr("acc"),a=$(this).find("i").attr("file-state"),n=$(this).parents("tr").find("td").attr("del-time"),r=$(this).parents("tr").find("td").eq(0).attr("id"),d=$(this).parents("tr").find("td").eq(0).children("label").find("i").attr("alt");if("failure"==a||"await"==a||"start"==a||"on"==a)return $(this).parents("tr").find("td").eq(0).children("label").removeClass("checked"),!0;$(this).parents("tr").find("td").eq(6).find("div").removeClass("success").addClass("now_switch").html("正在转换"),$(this).parents("tr").find("td").eq(5).find("div").attr("name","disabled").addClass("rmoveData"),$(this).parents("tr").find("td").eq(7).find("div").removeClass("reture_switch").removeClass("start_switch").addClass("loading").html("");var l=$(".sendfor_email .checked").length;if(1==l)var o=$("#email").val();s.push({fileName:e,fileType:t,fileSize:d,suffix:i,fileTime:n,id:r,email:o})}),s.length>0&&$.ajax({type:"post",url:t,data:{fileInfo:JSON.stringify(s)},dataType:"json",success:function(a){var n=$("#fileVal").val().split(","),r=$(".table tr"),d=r.length;if(1==a.action){conversion.batch_url==t&&e.fileAjaxAsynchronous(s,"timngProcess");for(var l=a.success,o=[],f=[],c=0;c<l.length;c++)for(var v=1;v<=d;v++){var h=r.eq(v),m=h.find("td").eq(1).children("div").find("h3").html(),p=h.find("td").eq(0).children("label").find("i").attr("alt"),u=h.find("td").eq(0).attr("id"),_=h.find("td").eq(0).children("label").find("i").attr("file-state"),b=(h.find("td").eq(3).find("div").html(),h.find("td").eq(5).find(".drop").find("div").html()),k=h.find("td").eq(0).attr("del-time"),w=h.find("td").eq(0).attr("f-name");if(m==l[c].fileName&&"successful"==_&&b==l[c].fileType&&l[c].fileSize==p)if(1==l[c].fileState){e.fileAjaxAsynchronous(s,"timngProcess"),h.find("td").eq(7).find("div").removeClass("failure loading").addClass("now_down").html("下载").attr("onclick","conversion.getDownload(this,'"+l[c].m_id+"')"),h.find("td").eq(6).find("div").removeClass("failure now_switch").addClass("success").html("转换成功"),h.find("td").eq(0).children("label").find("i").attr("file-state","on"),h.find("td").eq(5).find(".drop").attr("disabled",!0),h.find("td").eq(0).children("label").removeClass("checked");var q={fid:u,fileName:m,fsize:p,cstate:1,cTime:k,cstyle:2,cName:w};f.push(q)}else if(2==l[c].fileState){e.fileAjaxAsynchronous(s,"timngProcess"),h.find("td").eq(7).find("div").removeClass("loading").addClass("reture_switch").html("重新转换").attr("onclick","conversion.startTransition(this)"),h.find("td").eq(6).find("div").addClass("failure").html("转换失败"),h.find("td").eq(0).children("label").find("i").attr("file-state","on"),h.find("td").eq(0).children("label").find("i").attr("file-failure","2");var q={fid:u,fileName:m,fsize:p,cstate:2,cTime:k,cstyle:2,cName:w};f.push(q)}else if(5==l[c].fileState){e.fileAjaxAsynchronous(s,"timngProcess"),h.find("td").eq(7).find("div").removeClass("loading").addClass("down_client").html('<a href="http://file1.cqttech.com/soft/Yueshu/YueShuPDF_setup.exe" target="_blank">下载客户端</a>'),h.find("td").eq(6).find("div").addClass("failure").html("转换超时");var q={fid:u,fileName:m,fsize:p,cstate:5,cTime:k,cstyle:2,cName:w};f.push(q)}else if(6==l[c].fileState){e.fileAjaxAsynchronous(s,"timngProcess"),h.find("td").eq(0).children("label").find("i").attr("file-state","failure"),h.find("td").eq(7).find("div").removeClass("loading").addClass("rg_vip").html(conversion.getHost(6)),h.find("td").eq(6).find("div").addClass("failure").html("每日可免费转换一次50页PDF");var q={fid:u,fileName:m,fsize:p,cstate:5,cTime:k,cstyle:2,cName:w};f.push(q)}else o[c]=c}$("#fileVal").val(n.join(",")),o.length>0?setTimeout(function(){i.AskBatchConversionSendPerform("/Home/Index/batchConversionAjax")},4500):($(".batchUpload").removeClass("batchNone").attr("href","javascript:batchConversion();"),ajaxFile=!1,clearTimeout(i.AskBatchConversionSendPerform),e.ajaxLoadShoppingMember(),e.ajaxLoadShoppingHeader())}}})}else clearTimeout(i.AskBatchConversionSendPerform)}};i.init()},batch_delete:function(){var t=$("#fileVal").val().split(","),i=$(".upload_file .checked").length,a=t.length;if(i>0){var s='是否确认删除当前<font color="red">'+i+"</font>个文档",n={title:"删除",btn:parseInt("0011",2),onOk:function(){for(var s=[],n=i-1;n>=0;n--){var r=$(".upload_file .checked").eq(n).parents("tr").find("td").eq(1).children("div").find("h3").html(),d=$(".upload_file .checked").eq(n).parents("tr").find("td").eq(3).find("div").html(),l=$(".upload_file .checked").eq(n).parents("tr").find("td").eq(0).children("label").find("i").attr("alt"),o=$(".upload_file .checked").eq(n).parents("tr").find("td").eq(0).attr("id"),f=$(".upload_file .checked").eq(n).parents("tr").find("td").eq(0).attr("del-time"),c={fid:o,fileName:r,fsize:l,delTime:f,dstyle:2};if(s.push(c),a>0){var v=d+"_"+l+"_"+r,h=$.inArray(v,t);h!=-1&&t.splice(h,1),$("#fileVal").val(t.join(","))}$(".upload_file .checked").eq(n).parents("tr").remove()}s.length>0&&e.fileAjax(s,"delete");var m=$(".table tr");0==m.length&&(window.timestamp=Date.parse(new Date)/1e3,e.setCookie("timestamp",window.timestamp,.354))}};window.wxc.xcConfirm(s,window.wxc.xcConfirm.typeEnum.confirm,n)}},delete_one:function(){$(document).on("click",".icon_delete",function(){var t=$(this).parents("tr").find("td").eq(0).attr("id"),i=$(this).parents("tr").find("td").eq(0).attr("del-time"),a=$(this).attr("alt"),s=$(this),n=$(this).parents("tr").find("td").eq(3).find("div").html(),r=$(this).parents("tr").find("td").eq(0).children("label").find("i").attr("alt"),d=$("#fileVal").val().split(","),l="是否确认删除文件："+a,o={title:"删除",btn:parseInt("0011",2),onOk:function(){if(d.length>0){var l=n+"_"+r+"_"+a,o=$.inArray(l,d);o!=-1&&d.splice(o,1),$("#fileVal").val(d.join(","))}s.parents("tr").remove();var f=[{fid:t,fileName:a,fsize:r,dstyle:1,delTime:i}];e.fileAjax(f,"delete");var c=$(".table tr");0==c.length&&(window.timestamp=Date.parse(new Date)/1e3,e.setCookie("timestamp",window.timestamp,.354))}};window.wxc.xcConfirm(l,window.wxc.xcConfirm.typeEnum.info,o)})},jquery_event:function(){$(document).on("click",".upload_file .label",function(){$(this).hasClass("checked")?$(this).removeClass("checked"):$(this).addClass("checked")}),$(".file_operation .all_choose").click(function(){var e=$(".upload_file .label").length,t=$(".upload_file .checked").length;e==t?$(".upload_file .label").removeClass("checked"):$(".upload_file .label").addClass("checked")}),$(".in_turn").click(function(){for(var e=0;e<$(".upload_file .label").length;e++)$(".upload_file .label").eq(e).hasClass("checked")?$(".upload_file .label").eq(e).removeClass("checked"):$(".upload_file .label").eq(e).addClass("checked")}),""==$("#Authorizationtype").val()?$(".btn_file").css({background:"#d2d2d2",color:"#fff",cursor:"not-allowed"}).find(".bubble_promet").show().siblings("#fileupload").hide():$(".btn_file").removeAttr("style").find(".bubble_promet").hide().siblings("#fileupload").show(),$(".choose_file_box .label").click(function(){$(this).hasClass("checked")?($(this).removeClass("checked"),$(this).siblings(".email_div").hide(),$(this).parent().find(".btn_file").css({background:"#d2d2d2",color:"#fff",cursor:"not-allowed"}).find(".bubble_promet").show().siblings("#fileupload").hide(),""!==$("#Authorizationtype").val()&&$(".bubble_promet").hide()):($(this).addClass("checked"),$(this).siblings(".email_div").show(),""!==$("#Authorizationtype").val()&&$(this).parent().find(".btn_file").removeAttr("style").find(".bubble_promet").hide().siblings("#fileupload").show())}),$(document).on("click",".drop",function(e){e.stopPropagation(),$(this).not(".rmoveData").find(".secondary").is(":hidden")?($(this).find(".secondary").show(),$(this).parents("tr").siblings("tr").find(".secondary").hide()):$(this).find(".secondary").hide()}),$(document).on("click",".secondary li",function(e){e.stopPropagation();var t=$(this).text();$(this).parent().siblings(".info").text(t),$(this).parent().hide()}),$(document).click(function(){$(".secondary").hide()})}}});