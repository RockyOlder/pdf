function generaAlypay(t){$(".popup_actpay").hide(),$(".popup .content").hide(),$(".popup_zfb").show(),$("#pay_Waiting").show(),ajaxCount({s_status:3,s_value:t},"AjaxActiviOrderPay"),onloadQueryApplayOrderPAy()}function sendWXorder(t){var e="/Ucenter/Financial/doAddDepositOnline",a=$("#o_id").val();$.ajax({url:e,dataType:"html",type:"post",data:{details:2,pdt_id:t,activity:1,activity_o_id:a,pc_abbreviation:"WEIXIN"},success:function(e){$(".popup_content").html(e);var a=$("#getSysconfigActivity").val();if(2==a)$(".popup_actpay").hide(),$(".popup .content").hide(),$(".act_promet").show();else{var n=$("#PaymentSerialCount").val();1!==n&&($(".popup_actpay").hide(),$(".popup .content").hide(),$(".popup_weixin").show(),$(".popup_weixin .content").show(),$(".popup_weixin .content").css({"margin-top":($(window).height()-460)/2}),$(".popup_weixin .close").click(function(){$("#weixin_ifram").remove(),$(".popup_weixin").hide()}),ajaxCount({s_status:2,s_value:t},"AjaxActiviOrderPay"),onloadQueryOrderPAy())}}})}function ajaxCount(t,e){$.ajax({type:"post",url:"/Home/Index/"+e,data:{fileInfo:JSON.stringify(t)},dataType:"json",success:function(t){}})}function onloadQueryOrderPAy(){$.ajax({url:"/Ucenter/Orders/getOrderPyOid/?order_no="+$("#order_no").val()+"&t="+Math.round(1e6*Math.random()),type:"GET",dataType:"json",success:function(t){if(1==t.status){$("#weixin_ifram").remove(),$(".popup_weixin").hide(),clearTimeout(onloadQueryOrderPAy),ajaxCount({s_status:5,s_value:$("#order_no").val()},"AjaxActiviOrderPay");var e={title:"确定",btn:parseInt("0011",2),onOk:function(){window.location.href=t.url[0]}};ajaxLoadShoppingHeader(),window.wxc.xcConfirm("已支付成功，进入转换界面",window.wxc.xcConfirm.typeEnum.success,e)}else $(".popup_weixin").is(":hidden")?clearTimeout(onloadQueryOrderPAy):setTimeout(function(){onloadQueryOrderPAy()},3e3)}})}function generateOrder(t){$.ajax({url:"/Ucenter/Financial/ALIPAYPayOnline",dataType:"json",type:"post",async:!0,data:{details:2,pdt_id:t,activity:1,pc_abbreviation:"ALIPAY"},success:function(t){if(1==t.action){$("#o_id").val(t.data.o_id);var e="/Ucenter/Financial/doALIPAY?code=ALIPAY&o_id="+t.data.o_id+"&details=2";$(".zfb_pay a").attr("href",e),$(".popup_actpay").show(),$(".popup_actpay .content").show()}else 2==t.action&&2==t.activity&&($(".popup_actpay").hide(),$(".popup .content").hide(),$(".act_promet").show())}})}function onloadQueryApplayOrderPAy(){$.ajax({url:"/Ucenter/Orders/getApplayOid/?order_no="+$("#o_id").val()+"&t="+Math.round(1e6*Math.random()),type:"GET",dataType:"json",success:function(t){1==t.action?($("#pay_Waiting").hide(),$("#play_success").show(),$("#play_success").css("display","inline-block").siblings().hide(),$("#pay_sccess_price").html(t.order.o_all_price),$("#total_number").html(t.order.number_remaining),$("#total_time").html(t.order.end_time),ajaxCount({s_status:4,s_value:$("#o_id").val()},"AjaxActiviOrderPay"),ajaxLoadShoppingHeader(),clearTimeout(onloadQueryApplayOrderPAy)):$("#pay_Waiting").is(":hidden")?clearTimeout(onloadQueryApplayOrderPAy):setTimeout(function(){onloadQueryApplayOrderPAy()},3e3)}})}function ajaxLoadShoppingHeader(){$("#hederGet").remove(),$("#header_tag_data").remove(),$.post("/Home/Index/getHeaderData",{},function(t){$("#appendHtml").html(t)},"html")}function ajaxLoadLoginpingMember(){$.post("/Home/Index/showMemberInfo",{},function(t){$(".main_main").children("div").remove(),$(".main_main").html(t)},"html")}function accMul(t,e){var a=0,n=t.toString(),i=e.toString();try{a+=n.split(".")[1].length}catch(o){}try{a+=i.split(".")[1].length}catch(o){}return Number(n.replace(".",""))*Number(i.replace(".",""))/Math.pow(10,a)}function checkEmail(t){var e=/^(\w-*\.*)+@(\w-?)+(\.\w{2,})+$/;return e.test(t)?t:void alert("请输入正确的邮箱格式")}function lookProperty(obj){ob=eval(obj);var Property="";for(var i in ob)Property+="属性："+i+"<br/>",document.getElementById("myp").innerHTML=Property}function fileAjax(t,e){$.ajax({type:"post",url:"/Home/Index/"+e,data:{fileInfo:JSON.stringify(t)},dataType:"json",success:function(t){}})}function getFileDownload(t,e){$.ajax({type:"post",url:"/Home/Index/getFileDownload",data:{m_id:t,id:e},dataType:"json",async:!1,success:function(t){if(1==t.action){var e="/Home/Index/downloadFile?url="+t.downUrl+"&key="+t.key+"&id="+t.id;location.href=encodeURI(encodeURI(e))}}})}function accSub(t,e){return accAdd(t,-e)}function accAdd(t,e){var a,n,i;try{a=t.toString().split(".")[1].length}catch(o){a=0}try{n=e.toString().split(".")[1].length}catch(o){n=0}return i=Math.pow(10,Math.max(a,n)),(t*i+e*i)/i}require.config({paths:{wxLogin:"http://res.wx.qq.com/connect/zh_CN/htmledition/js/wxLogin"}}),require(["jquery","xcConfirm","tool","wxLogin"],function(t,e,a,n){a.checkNotEmpty(t("#year").val())&&a.checkNotEmpty(t("#month").val())&&a.checkNotEmpty(t("#day").val())&&a.ShowCountDown(),t(document).ready(function(){window.hostUrl=window.location.origin,t(document).on("click",".column > i",function(){var e=t(this).attr("file-state");"successful"==e&&t(this).toggleClass("checkbox")}),t(document).on("click",".change",function(){var e=t(this).html();"重新选择"==e&&t("#fileupload").click()});var e=!0;t(document).on("click",".type > ul > li",function(){t(this).closest("ul").siblings("input").val(t(this).children("em").html()),e=!1}),t(".check").click(function(){for(var e=t(".list > li").length,a=0;a<e;a++){var n=t(".list > li").eq(a).children(".wrapper").children(".column").children("i");"successful"==n.attr("file-state")&&n.addClass("checkbox")}})}),t(function(){function e(e,n){t(".original").show();var i=t("#end_time").val(),o=t("#end_time_count_out").val();t("#pay .save_money").html("省"+(n-e)+"元"),t("#pay .pay_money").html(e+"元"),t("#pay .first_price").html("原价"+n+"元"),i<=7&&0!=i?(a.yearsMiddle(9),t(".last_pay .pay_money").html(accMul(e,.9))):o<=30&&0!=o?(a.yearsMiddle(9.5),t(".last_pay .pay_money").html(accMul(e,.95))):(0==i&&0==o||o>30||i>7)&&(a.yearsMiddle2(),t(".last_pay .pay_money").html(e))}function n(e){t(".discount").html(""),t("#pay .save_money").html(""),t("#pay .first_price").html(""),t(".original").hide();var a=parseInt(t("#times").data("now"));if(t(".last_pay .pay_money").html(a*e),e%5==0){var n=parseInt(e)+parseInt(e/5);t(".give_promet span").html(n)}else{var n=parseInt(e)+Math.floor(e/5);t(".give_promet span").html(n)}}function i(){var e="/Home/Index/weixinlogin";return t.ajax({url:e,dataType:"html",data:{redirect:t("#redirect").val()},type:"post",async:!1,success:function(e){t(".popup_weixin").html(e),t(".popup_weixin").show(),t(".actlogin_promet").hide(),t(".popup_weixin .content").css({"margin-top":(t(window).height()-460)/2}),t(".popup_weixin .close").click(function(){t("#weixin_ifram").remove(),t(".popup_weixin").hide()})}}),!1}function o(){var e=t("#Authorizationtype").val();""!==e?(t(".popup_actpay").show(),t(".popup_actpay .content").show()):(t(".actlogin_promet").show(),setTimeout(function(){t(".actlogin_promet").hide(),i()},1e3))}t(".email_div .email").change(function(){var e=t(this).val();checkEmail(e)}),t(".upload_file .label").click(function(){t(this).hasClass("checked")?t(this).removeClass("checked"):t(this).addClass("checked")}),t(".icon_delete").click(function(){t(this).parents("tr").remove()}),t(".package .item").not(".num_input").click(function(){t("#pdt_id").val(t(this).data("pdt_id")),t("#pdt_sn").val(t(this).data("pdt_sn")),t("#pdt_sale_price").val(t(this).data("now")),t("#details").val(t(this).data("details")),t(this).addClass("current").siblings(".item").removeClass("current"),t(this).parents(".section").siblings(".section").find(".item").removeClass("current");var a=t(this).data("now"),n=t(this).data("first");e(a,n)});var c=t('.item[name="tc_default"]').data("now"),r=t('.item[name="tc_default"]').data("first");e(c,r);var s=t(".section_one .amount").val();t(".add_numberof").click(function(){s++,s>1e3&&(s=1e3),t("#pdt_id").val(1),t(".section_one .amount").val(s),n(s)}),t(".reduce_numberof").click(function(){s>1?(s--,t(".section_one .amount").val(s),t("#pdt_stock").val(s),t("#pdt_id").val(1),n(s)):""==s&&(s=1)}),t(".upor_down").click(function(){t(this).parent().siblings(".item").addClass("current").parents(".section").siblings().find(".item").removeClass("current"),t("#pdt_stock").val(s),t("#details").val(t(this).parent().siblings(".item").data("details")),n(s)}),t("#times").click(function(){s=t(".section_one .amount").val(),t("#pdt_stock").val(s),t("#details").val(t(this).data("details")),t("#pdt_id").val(t(this).data("pdt_id")),t(this).addClass("current").parents(".section").siblings().find(".item").removeClass("current"),n(s)}),t(".section_one .amount").keyup(function(){var e=t(this).val();t(this).val(e.replace(/\D|^0/g,"")),""==t(this).val()&&t(this).val()}).bind("paste",function(){var e=parseInt(t(this).val());t(this).val(e.replace(/\D|^0/g,"")),""==t(this).val()&&t(this).val()}).css("ime-mode","disabled"),t(".section_one .amount").keyup(function(){s=t(".section_one .amount").val(),s>1e3&&(s=parseInt(1e3)),t(".section_one .amount").val(s),t("#pdt_stock").val(s),t("#pdt_id").val(1),t(this).parent().siblings(".item").addClass("current").parents(".section").siblings().find(".item").removeClass("current"),t("#details").val(t(this).parent().siblings(".item").data("details")),n(s),""==s&&(t(".section_one .amount").val(1),n(1),t(".give_promet span").html("1"))}),t(document).on("click",".login_weixin",function(){i()}),t(".popup_zfb .content").css("margin-top",(t(window).height()-460)/2),t(".success_box,.login_promet").css("min-height",t(window).height()-376),t(".btn_contain,.btn_return").click(function(){t("#play_success,.popup_zfb").hide()}),t(".zfb_info .btn_end").click(function(){t(".popup").hide()}),t(".choose_reason li").click(function(){t(this).addClass("on").siblings().removeClass("on")}),t(".popup .close").click(function(){t(this).parents(".popup_other,.content,.popup_zfb,.popup_actpay").hide(),t(this).parents(".popup_other").find(".content").hide()}),t(".choose_file .btn_file input").click(function(){t(this).blur()}),t(".add_banner .icon,.item_banner .icon").click(function(){t(this).parents(".add_banner,.item_banner").remove()});var l=window.location.href.split("#"),p=l.length-1,d=0,u="",h=t("#Authorizationtype").val();if(0==a.checkNotEmpty(t("#ACTIVITY_OPEN").val())){if("01"==l[p]){u=t(".onemouth img").attr("setsrc"),d=t(".onemouth .btn").data("pay");var m=t(".onemouth .btn").data("details");generateOrder(m),t(".zfb_pay").attr("onclick","generaAlypay("+m+")"),t(".weixin_pay").attr("onclick","sendWXorder("+m+")"),o()}else if("02"==l[p]){u=t(".oneyears img").attr("setsrc"),d=t(".oneyears .btn").data("pay");var m=t(".oneyears .btn").data("details");generateOrder(m),t(".zfb_pay").attr("onclick","generaAlypay("+m+")"),t(".weixin_pay").attr("onclick","sendWXorder("+m+")"),o()}else if("03"==l[p]){u=t(".twoyears img").attr("setsrc"),d=t(".twoyears .btn").data("pay");var m=t(".twoyears .btn").data("details");generateOrder(m),t(".zfb_pay").attr("onclick","generaAlypay("+m+")"),t(".weixin_pay").attr("onclick","sendWXorder("+m+")"),o()}t(".popup_actpay .imgtype").attr("src",u)}else t(".act_promet").show();t(".act_type_box .btn").click(function(){if(""!==h){d=t(this).data("pay");var e=t(this).data("details");u=t(this).parent().siblings("img").attr("setsrc"),generateOrder(e),t(".zfb_pay").attr("onclick","generaAlypay("+e+")"),t(".weixin_pay").attr("onclick","sendWXorder("+e+")"),t(".popup_actpay .imgtype").attr("src",u)}else t(".actlogin_promet").show(),setTimeout(function(){t(".actlogin_promet").hide(),i()},1e3)})})});